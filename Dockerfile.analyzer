FROM python:3.12-slim
WORKDIR /app
ENV PYTHONUNBUFFERED=1 \
    PIP_DISABLE_PIP_VERSION_CHECK=1 \
    POETRY_VIRTUALENVS_CREATE=false \
    POETRY_NO_INTERACTION=1
COPY pyproject.toml poetry.lock* ./
RUN pip install --no-cache-dir poetry && poetry install --no-root --no-ansi
COPY . .
# Default environment values (override via docker-compose / .env)
ENV ANALYZER_INPUT=/data/anomalies.jsonl \
    ANALYZER_WATCH=1 \
    ANALYZER_TAIL_INTERVAL=30 \
    ANALYZER_WINDOW_MINUTES=5 \
    ANALYZER_PROVIDER=none \
    ANALYZER_INVOKE_LLM=0 \
    ANALYZER_MIN_TRIGGER_SEVERITY=major \
    ANALYZER_LLM_COOLDOWN_SECONDS=300
ENTRYPOINT ["python","llm_analyzer.py"]


